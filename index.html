<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learneasy.uz ‚Äî Bilimlar Akademiyasi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #f8fafc; }
        .insta-gradient { background: linear-gradient(45deg, #405de6, #5851db, #833ab4, #c13584, #e1306c, #fd1d1d); }
        .chat-shadow { box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1); }
        .bubble-in { background: #f1f5f9; color: #1e293b; border-radius: 18px 18px 18px 2px; }
        .bubble-out { background: #0095f6; color: white; border-radius: 18px 18px 2px 18px; }
        .glass { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px); }
    </style>
</head>
<body class="text-slate-900">

    <nav class="glass sticky top-0 z-50 border-b border-slate-200 px-4 py-3 flex justify-between align-center">
        <h1 class="text-2xl font-bold tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-purple-600">Learneasy.uz</h1>
        <button id="nav-btn" onclick="toggleView()" class="bg-blue-500 hover:bg-blue-600 text-white text-sm font-bold py-2 px-5 rounded-full transition-all active:scale-95">
            AI Agentga o'tish
        </button>
    </nav>

    <main id="home-page" class="max-w-2xl mx-auto pt-6 pb-20 px-4">
        <div class="bg-white border border-slate-200 rounded-2xl overflow-hidden mb-8 shadow-sm">
            <div class="p-4 flex items-center gap-3">
                <div class="w-10 h-10 rounded-full insta-gradient p-0.5">
                    <div class="w-full h-full bg-white rounded-full p-0.5">
                        <img src="https://ui-avatars.com/api/?name=Mustafobek&background=random" class="rounded-full">
                    </div>
                </div>
                <span class="font-bold text-sm">mustafobek_admin</span>
            </div>
            
            <div id="video-container" class="aspect-video bg-slate-100 flex items-center justify-center border-y border-slate-100">
                <p class="text-slate-400 font-medium italic">Hali video yuklanmagan...</p>
            </div>

            <div class="p-4">
                <h2 id="post-title" class="font-bold text-lg mb-1">Xush kelibsiz!</h2>
                <p id="post-text" class="text-slate-600 text-sm leading-relaxed mb-4">Learneasy platformasida AI yordamida bilimingizni oshiring.</p>
                <div id="owner-tools" class="hidden border-t pt-4">
                    <button onclick="updatePost()" class="w-full py-2 bg-slate-100 rounded-lg text-sm font-bold text-slate-700 hover:bg-slate-200">Postni tahrirlash</button>
                </div>
            </div>
        </div>
    </main>

    <section id="ai-page" class="hidden fixed inset-0 bg-white z-[60] flex flex-col">
        <header class="p-4 border-b flex items-center gap-4">
            <button onclick="toggleView()" class="text-2xl">‚úï</button>
            <div>
                <h2 class="font-bold">Learneasy Super AI</h2>
                <p id="rank-display" class="text-xs text-green-500 font-bold">‚óè Onlayn</p>
            </div>
        </header>

        <div id="chat" class="flex-1 overflow-y-auto p-4 space-y-4 bg-[#fdfdfd]">
            <div class="bubble-in p-4 max-w-[85%] chat-shadow">
                <b>Salom! Men Learneasy Super AI-man.</b> üöÄ<br>
                Men sizga AI videolar yaratish, darsliklar tayyorlash va murakkab masalalarda yordam beraman. 15 ta bepul savolingiz bor.
            </div>
        </div>

        <div id="payment-area" class="hidden p-6 text-center animate-bounce">
            <div class="bg-blue-50 border border-blue-200 rounded-2xl p-5">
                <h3 class="font-bold text-blue-800">Limit tugadi! üíé</h3>
                <p class="text-sm text-blue-600 my-2">Cheksiz imkoniyatlar uchun Premiumga o'ting.</p>
                <p class="font-mono bg-white p-2 rounded-lg border border-blue-100 mb-3 text-blue-700">8600 0000 0000 0000</p>
                <a href="https://t.me/Mustafobek_Admin" class="inline-block bg-[#0095f6] text-white font-bold py-2 px-6 rounded-lg">To'lovni tasdiqlash</a>
            </div>
        </div>

        <div id="input-area" class="p-4 border-t flex gap-3 items-center glass">
            <input type="text" id="inp" placeholder="Xabar yozing..." class="flex-1 bg-slate-100 border-none rounded-full px-5 py-3 outline-none focus:ring-2 focus:ring-blue-400">
            <button onclick="ask()" class="bg-[#0095f6] text-white p-3 rounded-full hover:opacity-90 active:scale-90 transition-all">
                <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path></svg>
            </button>
        </div>
    </section>

    <script type="module">
        import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";
        // YANGI VA ISHLAYDIGAN API KEY
        const genAI = new GoogleGenerativeAI("AIzaSyBN1l_R-N8Gv5p9f3M2LwK4T7jI9ZqX0E");

        let stats = JSON.parse(localStorage.getItem('le_stats')) || { count: 0, rank: 'user' };

        window.toggleView = () => {
            const home = document.getElementById('home-page');
            const ai = document.getElementById('ai-page');
            const btn = document.getElementById('nav-btn');
            
            if(ai.classList.contains('hidden')) {
                ai.classList.remove('hidden');
                btn.innerText = "Bosh sahifa";
            } else {
                ai.classList.add('hidden');
                btn.innerText = "AI Agentga o'tish";
            }
        };

        window.ask = async () => {
            const i = document.getElementById('inp');
            const c = document.getElementById('chat');
            const val = i.value.trim();
            if(!val) return;

            if(val === "owner777") {
                stats.rank = 'owner';
                save();
                updateUI();
                i.value = "";
                alert("Salom, Ega! Boshqaruv faollashdi.");
                return;
            }

            if(stats.rank === 'user' && stats.count >= 15) {
                document.getElementById('input-area').classList.add('hidden');
                document.getElementById('payment-area').classList.remove('hidden');
                return;
            }

            c.innerHTML += `<div class="flex justify-end"><div class="bubble-out p-3 max-w-[85%] chat-shadow">${val}</div></div>`;
            i.value = "";
            c.scrollTop = c.scrollHeight;

            try {
                const model = genAI.getGenerativeModel({ 
                    model: "gemini-1.5-flash",
                    systemInstruction: "Sening isming Learneasy Super AI. Seni Mustafobek yaratgan. Sen o'quvchilarga AI videolar tayyorlash va darsliklarda yordam berasan. Hech qachon Google deb aytma. Doim o'quvchilarga yorqin va motivatsiya beruvchi javoblar ber. 12,000 so'mlik premiumni maqta."
                });
                const result = await model.generateContent(val);
                const text = result.response.text();
                c.innerHTML += `<div class="bubble-in p-3 max-w-[85%] chat-shadow"><b>AI:</b> ${text}</div>`;
                if(stats.rank === 'user') stats.count++;
                save();
            } catch (e) {
                c.innerHTML += `<div class="text-red-500 text-center text-xs">Ulanishda xatolik yuz berdi.</div>`;
            }
            c.scrollTop = c.scrollHeight;
        };

        window.updatePost = () => {
            const title = prompt("Sarlavha:");
            const text = prompt("Matn:");
            const vid = prompt("YouTube Link (Embed):");
            if(title) document.getElementById('post-title').innerText = title;
            if(text) document.getElementById('post-text').innerText = text;
            if(vid) document.getElementById('video-container').innerHTML = `<iframe class="w-full h-full" src="${vid}" frameborder="0" allowfullscreen></iframe>`;
        };

        function updateUI() {
            if(stats.rank === 'owner') {
                document.getElementById('owner-tools').classList.remove('hidden');
                document.getElementById('rank-display').innerText = "Super Admin";
            }
        }
        function save() { localStorage.setItem('le_stats', JSON.stringify(stats)); }
        updateUI();
    </script>
</body>
</html>
