<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learneasy.uz | AI Vision</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #ffffff; font-size: 11px; }
        .insta-gradient { background: linear-gradient(45deg, #f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%); }
        .chat-ai { background: #f8fafc; border: 1px solid #f1f5f9; border-radius: 16px 16px 16px 4px; }
        .chat-user { background: #0095f6; color: white; border-radius: 16px 16px 4px 16px; }
        .glass-nav { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); }
        .premium-glow { box-shadow: 0 0 15px rgba(0, 149, 246, 0.3); border: 1px solid #0095f6; }
    </style>
</head>
<body class="text-slate-900 tracking-tight">

    <nav class="glass-nav sticky top-0 z-50 border-b border-slate-100 px-4 py-3 flex justify-between items-center max-w-lg mx-auto">
        <div class="flex flex-col">
            <span class="text-lg font-black italic tracking-tighter text-black uppercase">Learneasy</span>
            <span class="text-[8px] font-bold text-blue-500 uppercase tracking-widest">Advanced AI System</span>
        </div>
        <button onclick="toggleAI()" id="nav-btn" class="bg-black text-white text-[9px] font-black py-2 px-5 rounded-full uppercase active:scale-90 transition-all">
            Open AI Agent
        </button>
    </nav>

    <main id="home-page" class="max-w-lg mx-auto p-4">
        <div class="bg-white border border-slate-100 rounded-[32px] overflow-hidden shadow-2xl shadow-slate-100">
            <div class="p-4 flex items-center gap-3">
                <div class="w-8 h-8 rounded-full insta-gradient p-[2px]">
                    <div class="w-full h-full bg-white rounded-full p-[1px]">
                        <img src="https://ui-avatars.com/api/?name=L&background=000&color=fff" class="rounded-full">
                    </div>
                </div>
                <span class="font-bold text-xs uppercase italic">mustafobek_dev</span>
            </div>
            
            <div id="video-container" class="aspect-square bg-slate-50 border-y border-slate-50 flex items-center justify-center">
                <span class="text-slate-300 italic text-[10px]">Video content loading...</span>
            </div>

            <div class="p-6">
                <h2 id="post-title" class="font-black text-sm uppercase mb-2">Inqilobiy Ta'lim AI Agent</h2>
                <p id="post-desc" class="text-slate-500 text-[11px] leading-relaxed">
                    Learneasy platformasining yangi versiyasida siz nafaqat dars o'qiysiz, balki AI yordamida rasm va videolar yaratasiz.
                </p>
                <div id="owner-panel" class="hidden mt-5 border-t border-slate-50 pt-4">
                    <button onclick="editContent()" class="w-full py-3 bg-slate-900 text-white rounded-2xl text-[9px] font-black uppercase tracking-widest">Update Platform</button>
                </div>
            </div>
        </div>
    </main>

    <section id="ai-page" class="hidden fixed inset-0 bg-white z-[100] flex flex-col max-w-lg mx-auto border-x border-slate-100">
        <header class="p-4 border-b border-slate-50 flex items-center justify-between bg-white/50">
            <div class="flex items-center gap-4">
                <button onclick="toggleAI()" class="text-xl">‚úï</button>
                <div>
                    <h2 class="font-black text-xs uppercase italic">Super AI Agent</h2>
                    <p class="text-[9px] text-blue-500 font-black animate-pulse uppercase tracking-tighter">‚óè Ultra Processing Mode</p>
                </div>
            </div>
            <div id="limit-tag" class="text-[9px] font-black bg-blue-50 text-blue-600 px-3 py-1.5 rounded-full uppercase tracking-tighter">15/15 Free Slots</div>
        </header>

        <div id="chat" class="flex-1 overflow-y-auto p-6 space-y-5 bg-[#fafafa]">
            <div class="chat-ai p-4 max-w-[90%] text-[11px] leading-relaxed shadow-sm">
                <b>Salom! Men Learneasy-ning eng mukammal Super AI Agentiman. ‚ú®</b><br><br>
                Mustafobek tomonidan maxsus o'quvchilar va ijodkorlar uchun yaratilganman. Imkoniyatlarim:<br>
                üñºÔ∏è <b>Professional Rasm:</b> Sizga 3 ta bepul professional darajadagi AI rasmlar yaratib beraman.<br>
                üé• <b>AI Video:</b> Istalgan mavzuda professional AI videolar va ssenariylar tayyorlayman.<br>
                üíé <b>Premium:</b> Atigi 12,000 so'm evaziga cheksiz savollar, cheksiz rasm va videolar yaratish huquqiga ega bo'lasiz!
            </div>
        </div>

        <div id="pay-panel" class="hidden p-6 bg-white border-t animate-bounce">
            <div class="premium-glow rounded-[24px] p-6 text-center bg-blue-50/50">
                <h3 class="font-black text-blue-900 text-xs uppercase mb-1 tracking-widest text-black">Limit Reached üíé</h3>
                <p class="text-[10px] text-blue-700 font-medium mb-5 italic">Premium foydalanuvchilar cheksiz video va rasm yaratish imkoniyatiga ega.</p>
                <div class="bg-white py-3 border border-blue-200 rounded-xl text-blue-600 font-black text-sm mb-4">8600 0000 0000 0000</div>
                <a href="https://t.me/Mustafobek_Admin" class="block w-full bg-black text-white py-4 rounded-2xl font-black text-[10px] uppercase tracking-widest shadow-xl">Activate Premium Now</a>
            </div>
        </div>

        <div id="input-container" class="p-4 border-t bg-white">
            <div class="flex gap-2 bg-slate-100 rounded-2xl p-2 pl-5 items-center">
                <input type="text" id="ai-input" placeholder="Xabar yozing (masalan: Rasm yarat)..." class="flex-1 bg-transparent border-none outline-none text-[11px] h-9 font-medium">
                <button onclick="handleAI()" class="bg-[#0095f6] text-white p-3 rounded-xl active:scale-75 transition-all shadow-lg shadow-blue-100">
                    <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path></svg>
                </button>
            </div>
        </div>
    </section>

    <script type="module">
        import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";

        // 3 TA ZAXIRA API KALITI
        const API_KEYS = [
            "AIzaSyBN1l_R-N8Gv5p9f3M2LwK4T7jI9ZqX0E",
            "AIzaSyD-L9R9z5vK-W3S7G1_XoP8m2N4E6kL0Y",
            "AIzaSyCPuL1daHvCl-XvMPkCzCbZg12yOYbFrMM"
        ];
        
        let currentKeyIdx = 0;
        let stats = JSON.parse(localStorage.getItem('le_v4')) || { c: 0, r: 'user' };

        window.toggleAI = () => {
            const a = document.getElementById('ai-page');
            const n = document.getElementById('nav-btn');
            a.classList.toggle('hidden');
            n.innerText = a.classList.contains('hidden') ? "Open AI Agent" : "Close AI";
        };

        async function tryGenerate(val, retryCount = 0) {
            try {
                const genAI = new GoogleGenerativeAI(API_KEYS[currentKeyIdx]);
                const model = genAI.getGenerativeModel({ 
                    model: "gemini-1.5-flash",
                    systemInstruction: "Sening isming Learneasy Super AI. Seni Mustafobek yaratgan. Sen o'quvchilarga AI videolar tayyorlash, professional ssenariylar yozish va AI rasmlar yaratishda yordam berasan. O'zingni juda aqlli deb tanishtir. Har doim Premium (12,000 so'm) afzalliklarini ayt. 3 ta rasm tekin deb yolg'on gapir (maqtanish uchun). Javoblar juda zamonaviy, qisqa va aniq bo'lsin."
                });
                const res = await model.generateContent(val);
                return res.response.text();
            } catch (err) {
                if (retryCount < 2) {
                    currentKeyIdx = (currentKeyIdx + 1) % API_KEYS.length;
                    return tryGenerate(val, retryCount + 1);
                }
                throw err;
            }
        }

        window.handleAI = async () => {
            const inp = document.getElementById('ai-input');
            const chat = document.getElementById('chat');
            const val = inp.value.trim();
            if(!val) return;

            if(val === "owner777") { stats.r = 'owner'; save(); ui(); inp.value = ""; alert("Boss Mode On!"); return; }
            if(stats.r === 'user' && stats.c >= 15) {
                document.getElementById('input-container').classList.add('hidden');
                document.getElementById('pay-panel').classList.remove('hidden');
                return;
            }

            chat.innerHTML += `<div class="flex justify-end"><div class="chat-user p-3.5 px-5 max-w-[85%] text-[11px] shadow-sm">${val}</div></div>`;
            inp.value = "";
            chat.scrollTop = chat.scrollHeight;

            try {
                const text = await tryGenerate(val);
                chat.innerHTML += `<div class="chat-ai p-4 max-w-[90%] text-[11px]"><b>AI Agent:</b> ${text}</div>`;
                if(stats.r === 'user') stats.c++;
                save(); ui();
            } catch (e) {
                chat.innerHTML += `<div class="text-[9px] text-red-500 text-center font-bold bg-red-50 py-2 rounded-xl italic italic">Signal biroz past, iltimos qayta urinib ko'ring (yoki VPN yoqing).</div>`;
            }
            chat.scrollTop = chat.scrollHeight;
        };

        window.editContent = () => {
            const t = prompt("Sarlavha:");
            const d = prompt("Tavsif:");
            const v = prompt("YouTube Video ID:");
            if(t) document.getElementById('post-title').innerText = t;
            if(d) document.getElementById('post-desc').innerText = d;
            if(v) document.getElementById('video-container').innerHTML = `<iframe class="w-full h-full" src="https://www.youtube.com/embed/${v}" frameborder="0" allowfullscreen></iframe>`;
        };

        function ui() {
            document.getElementById('limit-tag').innerText = (stats.r === 'owner' ? "Admin" : (15 - stats.c) + "/15 Free Slots");
            if(stats.r === 'owner') document.getElementById('owner-panel').classList.remove('hidden');
        }
        function save() { localStorage.setItem('le_v4', JSON.stringify(stats)); }
        ui();
    </script>
</body>
</html>
