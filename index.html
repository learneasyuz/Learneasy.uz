<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learneasy.uz | Premium AI Experience</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #fafafa; font-size: 13px; }
        .insta-border { border: 1px solid #dbdbdb; }
        .insta-gradient { background: radial-gradient(circle at 30% 107%, #fdf497 0%, #fdf497 5%, #fd5949 45%,#d6249f 60%,#285AEB 90%); }
        .chat-bubble-ai { background: #ffffff; border: 1px solid #efefef; border-radius: 15px 15px 15px 2px; box-shadow: 0 2px 5px rgba(0,0,0,0.03); }
        .chat-bubble-user { background: #0095f6; color: white; border-radius: 15px 15px 2px 15px; }
        .premium-card { background: linear-gradient(135deg, #ffffff 0%, #f0f9ff 100%); border: 1px solid #bae6fd; }
        input::placeholder { font-size: 12px; opacity: 0.7; }
    </style>
</head>
<body class="text-slate-800">

    <nav class="sticky top-0 z-50 bg-white border-b border-gray-200 px-4 py-2 flex justify-between items-center max-w-md mx-auto sm:max-w-none">
        <span class="text-xl font-bold tracking-tighter text-black italic">Learneasy</span>
        <button onclick="openAI()" class="bg-[#0095f6] hover:bg-[#1877f2] text-white text-[11px] font-bold py-1.5 px-4 rounded-md transition-all">
            AI Agentga o'tish
        </button>
    </nav>

    <main id="home-page" class="max-w-lg mx-auto py-4 px-2">
        <div class="bg-white insta-border rounded-lg mb-6 shadow-sm overflow-hidden">
            <div class="p-3 flex items-center gap-2">
                <div class="w-8 h-8 rounded-full insta-gradient p-[2px]">
                    <div class="w-full h-full bg-white rounded-full p-[1px]">
                        <img src="https://ui-avatars.com/api/?name=Admin&background=0095f6&color=fff" class="rounded-full">
                    </div>
                </div>
                <span class="font-semibold text-xs text-black">mustafobek_official</span>
            </div>
            
            <div id="video-box" class="aspect-square bg-gray-50 flex items-center justify-center border-y border-gray-100">
                <p class="text-gray-400 text-xs italic">Siz bu yerda yangi darsliklarni ko'rasiz</p>
            </div>

            <div class="p-4">
                <h2 id="p-title" class="font-bold text-sm mb-1 text-black">Yangi loyiha ishga tushdi!</h2>
                <p id="p-desc" class="text-gray-600 text-[12px] leading-relaxed">
                    Learneasy Super AI orqali endi darslarni yanada osonroq o'rganing. 
                    Premium obuna orqali cheksiz savollar va AI video darsliklarga ega bo'ling.
                </p>
                <div id="owner-btn" class="hidden mt-4">
                    <button onclick="adminEdit()" class="w-full py-2 bg-gray-50 border border-gray-200 rounded text-[11px] font-semibold text-gray-500 hover:bg-gray-100 transition-all">POSTNI TAHRIRLASH</button>
                </div>
            </div>
        </div>
    </main>

    <section id="ai-page" class="hidden fixed inset-0 bg-white z-[100] flex flex-col max-w-md mx-auto insta-border shadow-2xl">
        <header class="p-3 border-b flex items-center justify-between">
            <div class="flex items-center gap-3">
                <button onclick="closeAI()" class="text-xl">âœ•</button>
                <div>
                    <h2 class="font-bold text-sm">Super AI Intellect</h2>
                    <p class="text-[10px] text-green-500 font-medium">Faol holatda</p>
                </div>
            </div>
            <div id="limit-info" class="text-[10px] bg-gray-100 px-2 py-1 rounded-full text-gray-500 font-bold">15/15 bepul</div>
        </header>

        <div id="chat-box" class="flex-1 overflow-y-auto p-4 space-y-4 bg-[#fafafa]">
            <div class="chat-bubble-ai p-3 max-w-[90%] text-[12px] leading-relaxed">
                <b>Salom, men Learneasy Super AI-man!</b> âœ¨<br><br>
                Men Mustafobek tomonidan maxsus o'quvchilar uchun yaratilganman. Mening vazifam:<br>
                âœ… Murakkab masalalarni soniyada yechish<br>
                âœ… AI videolar uchun professional ssenariylar tayyorlash<br>
                âœ… Darsliklaringizni tahlil qilib, oson tushuntirish<br><br>
                Hozir sizda <b>15 ta bepul</b> imkoniyat bor. Uni tugatgach, atigi <b>12,000 so'm</b> evaziga Premiumga o'tib, cheksiz bilim olamiga kirishingiz mumkin!
            </div>
        </div>

        <div id="premium-ui" class="hidden p-4 premium-card mx-4 mb-4 rounded-xl shadow-lg animate-pulse">
            <h3 class="font-bold text-blue-900 text-xs">Premiumga o'ting ðŸ’Ž</h3>
            <p class="text-[11px] text-blue-700 my-1 font-medium">Limit tugadi. Premium foydalanuvchilar cheksiz savollar va barcha yangi funksiyalardan foydalana oladilar.</p>
            <div class="flex flex-col gap-2 mt-2">
                <div class="bg-white p-2 border border-blue-200 rounded text-center text-blue-600 font-bold text-sm">8600 0000 0000 0000</div>
                <a href="https://t.me/Mustafobek_Admin" class="bg-blue-500 text-white text-center py-2 rounded font-bold text-[11px]">To'lovni tasdiqlash (12,000 so'm)</a>
            </div>
        </div>

        <div id="ai-controls" class="p-3 border-t bg-white">
            <div class="flex gap-2 items-center bg-gray-50 rounded-full px-4 py-1.5 border border-gray-200">
                <input type="text" id="ai-input" placeholder="Yordam kerakmi?..." class="flex-1 bg-transparent border-none outline-none text-xs h-8">
                <button onclick="sendMsg()" class="text-[#0095f6] font-bold text-xs hover:text-blue-700">Yuborish</button>
            </div>
        </div>
    </section>

    <script type="module">
        import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";
        // YANGI VA ISHLAYDIGAN API KEY
        const genAI = new GoogleGenerativeAI("AIzaSyBN1l_R-N8Gv5p9f3M2LwK4T7jI9ZqX0E");

        let userData = JSON.parse(localStorage.getItem('le_app_data')) || { credits: 15, role: 'user' };

        window.openAI = () => document.getElementById('ai-page').classList.remove('hidden');
        window.closeAI = () => document.getElementById('ai-page').classList.add('hidden');

        window.sendMsg = async () => {
            const input = document.getElementById('ai-input');
            const chat = document.getElementById('chat-box');
            const val = input.value.trim();
            if(!val) return;

            if(val === "owner777") {
                userData.role = 'owner';
                save();
                updateDisplay();
                input.value = "";
                alert("Admin rejimi yoqildi!");
                return;
            }

            if(userData.role === 'user' && userData.credits <= 0) {
                document.getElementById('ai-controls').classList.add('hidden');
                document.getElementById('premium-ui').classList.remove('hidden');
                return;
            }

            chat.innerHTML += `<div class="flex justify-end"><div class="chat-bubble-user p-2.5 px-4 max-w-[80%] text-[12px] shadow-sm">${val}</div></div>`;
            input.value = "";
            chat.scrollTop = chat.scrollHeight;

            try {
                const model = genAI.getGenerativeModel({ 
                    model: "gemini-1.5-flash",
                    systemInstruction: "Sen Learneasy.uz ning Super AI Intellect modelisan. Seni Mustafobek yaratgan. O'quvchilarga yordam berasan. O'zingni juda aqlli deb tanishtir. Premium obunaning narxi 12,000 so'm ekanligini va u cheksiz ekanligini maqtab tushuntir. Javoblaring juda qisqa va aniq bo'lsin. Hech qachon Google haqida gapirma."
                });
                const result = await model.generateContent(val);
                chat.innerHTML += `<div class="chat-bubble-ai p-3 max-w-[90%] text-[12px]"><b>AI Agent:</b> ${result.response.text()}</div>`;
                if(userData.role === 'user') userData.credits--;
                save();
                updateDisplay();
            } catch (err) {
                chat.innerHTML += `<div class="text-red-400 text-[10px] text-center italic">Ulanishda xatolik yuz berdi.</div>`;
            }
            chat.scrollTop = chat.scrollHeight;
        };

        window.adminEdit = () => {
            const t = prompt("Sarlavha:");
            const d = prompt("Matn:");
            const v = prompt("YouTube Embed (Video ID):");
            if(t) document.getElementById('p-title').innerText = t;
            if(d) document.getElementById('p-desc').innerText = d;
            if(v) document.getElementById('video-box').innerHTML = `<iframe class="w-full h-full" src="https://www.youtube.com/embed/${v}" frameborder="0" allowfullscreen></iframe>`;
        };

        function updateDisplay() {
            document.getElementById('limit-info').innerText = (userData.role === 'owner' ? "Siz Adminsiz" : userData.credits + "/15 bepul");
            if(userData.role === 'owner') document.getElementById('owner-btn').classList.remove('hidden');
        }
        function save() { localStorage.setItem('le_app_data', JSON.stringify(userData)); }
        updateDisplay();
    </script>
</body>
</html>
